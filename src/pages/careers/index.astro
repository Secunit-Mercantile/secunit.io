---
import { type CollectionEntry, getCollection } from "astro:content";

// layouts
import BaseLayout from "@/layouts/BaseLayout.astro";

// components
import CareerGrid from "@/components/career/CareerGrid.astro";

// utils
import { filterCollectionByLanguage } from "@/js/localeUtils";
import { getLocaleFromUrl } from "@/js/localeUtils";

const currLocale = getLocaleFromUrl(Astro.url);

const careers: CollectionEntry<"careers">[] = await getCollection("careers", ({ data }) => {
 // filter out draft careers
 return data.draft !== true;
});

// get rid of careers from other languages and remove locale from slug
const filteredCareers = filterCollectionByLanguage(
 careers,
 currLocale,
) as CollectionEntry<"careers">[];

// sort careers by publish date
filteredCareers.sort(
 (a, b) => new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime(),
);
---

<BaseLayout title="Careers" description="Zenith Careers">
 <CareerGrid careers={filteredCareers} />
</BaseLayout>

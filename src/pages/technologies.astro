---
// layout
import BaseLayout from "@/layouts/BaseLayout.astro";
import { Icon } from "astro-icon/components";

// components
import Button from "@/components/button/Button.astro";

// utils
import { getLocaleFromUrl } from "@/js/localeUtils";
import { getLocalizedRoute } from "@/js/translationUtils";

// data
const currLocale = getLocaleFromUrl(Astro.url);

const pageTitle = "Technologies | Secunit Mercantile";
const pageDescription = "We're proficient in a wide range of modern technologies across cloud, DevOps, security, and AI.";

// Technology categories with logos from dashboard-icons
const categories = [
  {
    name: "Cloud Platforms",
    icon: "tabler/cloud",
    color: "sky",
    technologies: [
      { name: "AWS", logo: "amazon-web-services" },
      { name: "Google Cloud", logo: "google-cloud-platform" },
      { name: "Microsoft Azure", logo: "azure" },
      { name: "DigitalOcean", logo: "digital-ocean" },
      { name: "Cloudflare", logo: "cloudflare" },
      { name: "Linode", logo: "linode" },
    ],
  },
  {
    name: "Container & Orchestration",
    icon: "tabler/box",
    color: "blue",
    technologies: [
      { name: "Kubernetes", logo: "kubernetes" },
      { name: "Docker", logo: "docker" },
      { name: "Helm", logo: "helm" },
      { name: "Rancher", logo: "rancher" },
      { name: "K3s", logo: "k3s" },
      { name: "Podman", logo: "podman" },
    ],
  },
  {
    name: "CI/CD & GitOps",
    icon: "tabler/git-branch",
    color: "orange",
    technologies: [
      { name: "GitHub Actions", logo: "github" },
      { name: "GitLab CI", logo: "gitlab" },
      { name: "ArgoCD", logo: "argo-cd" },
      { name: "Jenkins", logo: "jenkins" },
      { name: "CircleCI", logo: "circleci" },
      { name: "Flux", logo: "flux-cd" },
    ],
  },
  {
    name: "Infrastructure as Code",
    icon: "tabler/code",
    color: "violet",
    technologies: [
      { name: "Terraform", logo: "terraform" },
      { name: "Pulumi", logo: "pulumi" },
      { name: "Ansible", logo: "ansible" },
      { name: "AWS CDK", logo: "amazon-web-services" },
      { name: "Crossplane", logo: "crossplane" },
      { name: "OpenTofu", logo: "opentofu" },
    ],
  },
  {
    name: "Observability & Monitoring",
    icon: "tabler/chart-line",
    color: "emerald",
    technologies: [
      { name: "Prometheus", logo: "prometheus" },
      { name: "Grafana", logo: "grafana" },
      { name: "Datadog", logo: "datadog" },
      { name: "New Relic", logo: "new-relic" },
      { name: "Elastic Stack", logo: "elasticsearch" },
      { name: "Jaeger", logo: "jaeger" },
    ],
  },
  {
    name: "Security & Compliance",
    icon: "tabler/shield-check",
    color: "red",
    technologies: [
      { name: "Vault", logo: "vault" },
      { name: "Snyk", logo: "snyk" },
      { name: "Trivy", logo: "trivy" },
      { name: "Falco", logo: "falco" },
      { name: "Wazuh", logo: "wazuh" },
      { name: "CrowdStrike", logo: "crowdstrike" },
    ],
  },
  {
    name: "AI & Machine Learning",
    icon: "tabler/brain",
    color: "pink",
    technologies: [
      { name: "OpenAI", logo: "openai" },
      { name: "Anthropic", logo: "anthropic" },
      { name: "Hugging Face", logo: "hugging-face" },
      { name: "LangChain", logo: "langchain" },
      { name: "AWS Bedrock", logo: "amazon-web-services" },
      { name: "Ollama", logo: "ollama" },
    ],
  },
  {
    name: "Databases & Storage",
    icon: "tabler/database",
    color: "amber",
    technologies: [
      { name: "PostgreSQL", logo: "postgresql" },
      { name: "MongoDB", logo: "mongodb" },
      { name: "Redis", logo: "redis" },
      { name: "MySQL", logo: "mysql" },
      { name: "ClickHouse", logo: "clickhouse" },
      { name: "MinIO", logo: "minio" },
    ],
  },
  {
    name: "Programming & Frameworks",
    icon: "tabler/terminal",
    color: "cyan",
    technologies: [
      { name: "Python", logo: "python" },
      { name: "Go", logo: "go" },
      { name: "TypeScript", logo: "typescript" },
      { name: "Rust", logo: "rust" },
      { name: "Node.js", logo: "node-js" },
      { name: "Bash", logo: "bash" },
    ],
  },
  {
    name: "Messaging & Streaming",
    icon: "tabler/message-dots",
    color: "indigo",
    technologies: [
      { name: "Kafka", logo: "apache-kafka" },
      { name: "RabbitMQ", logo: "rabbitmq" },
      { name: "NATS", logo: "nats" },
      { name: "AWS SQS", logo: "amazon-sqs" },
      { name: "Redis Streams", logo: "redis" },
      { name: "Pulsar", logo: "apache-pulsar" },
    ],
  },
];

// Color mapping for Tailwind classes
const colorClasses: Record<string, { bg: string; text: string; border: string }> = {
  sky: { bg: "bg-sky-500/10", text: "text-sky-500", border: "border-sky-500/20" },
  blue: { bg: "bg-blue-500/10", text: "text-blue-500", border: "border-blue-500/20" },
  orange: { bg: "bg-orange-500/10", text: "text-orange-500", border: "border-orange-500/20" },
  violet: { bg: "bg-violet-500/10", text: "text-violet-500", border: "border-violet-500/20" },
  emerald: { bg: "bg-emerald-500/10", text: "text-emerald-500", border: "border-emerald-500/20" },
  red: { bg: "bg-red-500/10", text: "text-red-500", border: "border-red-500/20" },
  pink: { bg: "bg-pink-500/10", text: "text-pink-500", border: "border-pink-500/20" },
  amber: { bg: "bg-amber-500/10", text: "text-amber-500", border: "border-amber-500/20" },
  cyan: { bg: "bg-cyan-500/10", text: "text-cyan-500", border: "border-cyan-500/20" },
  indigo: { bg: "bg-indigo-500/10", text: "text-indigo-500", border: "border-indigo-500/20" },
};

// Dashboard icons base URL
const iconBaseUrl = "https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons@main/svg";
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <!-- Page Header -->
  <section class="bg-muted/30 pt-32 pb-16">
    <div class="site-container">
      <div class="mx-auto max-w-3xl text-center" data-mos="fade-up">
        <span class="badge">Our Expertise</span>
        <h1 class="h1 mt-4">Technologies We Work With</h1>
        <p class="text-muted-foreground mt-6 text-lg">
          Deep expertise across modern cloud, DevOps, security, and AI technologies — so we can meet you where you are.
        </p>
      </div>
    </div>
  </section>

  <!-- Technologies Grid -->
  <section class="py-16">
    <div class="site-container">
      <div class="space-y-16">
        {categories.map((category, categoryIndex) => {
          const colors = colorClasses[category.color] || colorClasses.sky;
          return (
            <div 
              data-mos="fade-up" 
              data-mos-delay={categoryIndex * 0.05}
              class="tech-category"
            >
              <!-- Category Header -->
              <div class="mb-8 flex items-center gap-4">
                <div class:list={["flex h-12 w-12 items-center justify-center rounded-xl", colors.bg]}>
                  <Icon name={category.icon} class:list={["size-6", colors.text]} />
                </div>
                <h2 class="text-2xl font-bold text-foreground">{category.name}</h2>
              </div>

              <!-- Technology Cards -->
              <div class="grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6">
                {category.technologies.map((tech, techIndex) => (
                  <div 
                    class:list={[
                      "tech-card group relative flex flex-col items-center rounded-xl border p-4 transition-all duration-300",
                      "bg-card hover:bg-muted/50 border-border hover:border-primary/30",
                      "hover:shadow-lg hover:-translate-y-1"
                    ]}
                    style={`animation-delay: ${(categoryIndex * 0.05) + (techIndex * 0.02)}s`}
                  >
                    <div class="mb-3 flex h-12 w-12 items-center justify-center">
                      <img 
                        src={`${iconBaseUrl}/${tech.logo}.svg`}
                        alt={`${tech.name} logo`}
                        class="size-10 object-contain tech-logo"
                        loading="lazy"
                        onerror="this.onerror=null; this.src='/images/placeholder-icon.svg'; this.classList.add('opacity-30');"
                      />
                    </div>
                    <span class="text-center text-sm font-medium text-foreground/80 group-hover:text-foreground transition-colors">
                      {tech.name}
                    </span>
                  </div>
                ))}
              </div>
            </div>
          );
        })}
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="bg-muted/30 py-24">
    <div class="site-container">
      <div class="mx-auto max-w-3xl text-center" data-mos="fade-up">
        <h2 class="h2">Don't See Your Stack?</h2>
        <p class="text-muted-foreground mt-4 text-lg">
          We're always learning and adapting. If you're using something not listed here, let's chat — there's a good chance we've worked with it or can get up to speed quickly.
        </p>
        <div class="mt-8 flex flex-wrap items-center justify-center gap-4">
          <Button href={getLocalizedRoute(currLocale, "/contact")} class="px-8">
            Get in Touch
            <Icon name="tabler/arrow-right" class="ml-2 size-5" />
          </Button>
          <Button variant="outline" href={getLocalizedRoute(currLocale, "/services")} class="px-8">
            View Our Services
          </Button>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .tech-card {
    animation: fadeInUp 0.5s ease-out both;
  }

  .tech-logo {
    filter: grayscale(20%);
    transition: all 0.3s ease;
  }

  .tech-card:hover .tech-logo {
    filter: grayscale(0%);
    transform: scale(1.1);
  }

  /* Dark mode logo adjustments */
  :global(.dark) .tech-logo {
    filter: grayscale(20%) brightness(0.95);
  }

  :global(.dark) .tech-card:hover .tech-logo {
    filter: grayscale(0%) brightness(1.05);
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Staggered animation for tech cards */
  .tech-category:nth-child(1) .tech-card { animation-delay: calc(var(--index, 0) * 0.03s); }
  .tech-category:nth-child(2) .tech-card { animation-delay: calc(0.1s + var(--index, 0) * 0.03s); }
  .tech-category:nth-child(3) .tech-card { animation-delay: calc(0.2s + var(--index, 0) * 0.03s); }
</style>

